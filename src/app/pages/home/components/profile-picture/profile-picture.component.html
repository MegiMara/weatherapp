<div class="weather-app profile-container">
  <!-- Header -->
  <div class="profile-header">
    <button class="back-button" (click)="goHome()" type="button">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M19 12H5"></path>
        <polyline points="12,19 5,12 12,5"></polyline>
      </svg>
      Back to Home
    </button>
    <h1 class="page-title">My Profile</h1>
  </div>

  <!-- Main Profile Form -->
  <div class="profile-form-container">
    <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="profile-form">
      
      <!-- Avatar Section -->
      <div class="avatar-section">
        <div class="avatar-container">
          <!-- Display current avatar or default -->
          <div class="avatar-display">
            <img 
              *ngIf="avatarPreview" 
              [src]="avatarPreview" 
              [alt]="getUserDisplayName()"
              class="avatar-image"
            />
            <div 
              *ngIf="!avatarPreview" 
              class="default-avatar"
            >
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
            </div>
            
            <!-- Upload overlay on hover -->
            <div class="upload-overlay">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91-6.91a2.12 2.12 0 0 1 0-3l2.83-2.83a2.12 2.12 0 0 1 3 0l.13.13"></path>
              </svg>
              <span>Change Photo</span>
            </div>
          </div>
          
          <!-- Hidden file input -->
          <input 
            type="file" 
            #fileInput
            accept="image/*" 
            (change)="onAvatarChange($event)" 
            class="file-input"
          />
          
          <!-- Upload button -->
          <button 
            type="button" 
            class="upload-button"
            (click)="fileInput.click()"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7,10 12,15 17,10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Upload Photo
          </button>
          
          <!-- Remove button (only show if custom avatar) -->
          <button 
            *ngIf="selectedAvatarFile || (avatarPreview && avatarPreview !== getDefaultAvatar())"
            type="button" 
            class="remove-button"
            (click)="removeAvatar()"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
            Remove
          </button>
        </div>
        
        <div class="avatar-info">
          <h3>Profile Picture</h3>
          <p>Upload a photo to personalize your profile. JPG, PNG or GIF. Max size 5MB.</p>
        </div>
      </div>

      <!-- Form Fields -->
      <div class="form-fields">
        
        <!-- Username Field -->
        <div class="form-group">
          <label for="name" class="form-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            Username
          </label>
          <input 
            type="text" 
            id="name"
            formControlName="name"
            class="form-input"
            placeholder="Enter your username"
            [class.error]="profileForm.get('name')?.invalid && profileForm.get('name')?.touched"
          />
          <div 
            *ngIf="profileForm.get('name')?.invalid && profileForm.get('name')?.touched" 
            class="error-message"
          >
            <span *ngIf="profileForm.get('name')?.errors?.['required']">Username is required</span>
            <span *ngIf="profileForm.get('name')?.errors?.['minlength']">Username must be at least 2 characters</span>
          </div>
        </div>

        <!-- Email Field -->
        <div class="form-group">
          <label for="email" class="form-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
              <polyline points="22,6 12,13 2,6"></polyline>
            </svg>
            Email Address
          </label>
          <input 
            type="email" 
            id="email"
            formControlName="email"
            class="form-input"
            placeholder="Enter your email address"
            [class.error]="profileForm.get('email')?.invalid && profileForm.get('email')?.touched"
          />
          <div 
            *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched" 
            class="error-message"
          >
            <span *ngIf="profileForm.get('email')?.errors?.['required']">Email is required</span>
            <span *ngIf="profileForm.get('email')?.errors?.['email']">Please enter a valid email</span>
          </div>
        </div>

        <!-- Password Field -->
        <div class="form-group">
          <label for="password" class="form-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
              <circle cx="12" cy="16" r="1"></circle>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
            New Password
          </label>
          <input 
            type="password" 
            id="password"
            formControlName="password"
            class="form-input"
            placeholder="Leave blank to keep current password"
          />
          <small class="form-hint">Only enter if you want to change your password</small>
        </div>
      </div>

      <!-- Alert Messages -->
      <div *ngIf="error" class="alert error-alert">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="15" y1="9" x2="9" y2="15"></line>
          <line x1="9" y1="9" x2="15" y2="15"></line>
        </svg>
        {{ error }}
      </div>

      <div *ngIf="success" class="alert success-alert">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <polyline points="20,6 9,17 4,12"></polyline>
        </svg>
        {{ success }}
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button 
          type="button" 
          class="btn btn-secondary" 
          (click)="goHome()"
          [disabled]="isSaving"
        >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
          Cancel
        </button>
        
        <button 
          type="submit" 
          class="btn btn-primary"
          [disabled]="profileForm.invalid || isSaving"
        >
          <span *ngIf="!isSaving" class="btn-content">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <polyline points="20,6 9,17 4,12"></polyline>
            </svg>
            Save Changes
          </span>
          <span *ngIf="isSaving" class="btn-loading">
            <div class="spinner"></div>
            Saving...
          </span>
        </button>
        
        <button 
          type="button" 
          class="btn btn-danger"
          (click)="logout()"
          [disabled]="isSaving"
        >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16,17 21,12 16,7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
          Logout
        </button>
      </div>
      
    </form>
  </div>
</div>







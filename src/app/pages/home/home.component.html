<div class="home-container" [class.dark-theme]="isDarkTheme" (click)="onDocumentClick($event)">
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="navbar-left">
      <div class="logo">
        <img src="assets/images/weather-logo.svg" alt="Weather App" class="logo-image">
        <span class="logo-text">WeatherApp</span>
      </div>
      <app-current-time></app-current-time>
    </div>
    
    <div class="navbar-right">
      <div class="profile-dropdown-container">
        <button class="profile-btn" (click)="toggleProfileDropdown()" [class.active]="showProfileDropdown">
          <img 
            [src]="currentUser?.profilePicture || 'assets/images/default-avatar.svg'" 
            [alt]="currentUser?.username || 'User'"
            class="profile-avatar"
          >
          <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        
        <!-- Profile Dropdown Menu -->
        <div class="profile-dropdown" [class.show]="showProfileDropdown">
          <div class="dropdown-header">
            <img 
              [src]="currentUser?.profilePicture || 'assets/images/default-avatar.svg'" 
              [alt]="currentUser?.username || 'User'"
              class="dropdown-avatar"
            >
            <div class="user-info">
              <span class="username">{{ currentUser?.username || 'User' }}</span>
              <span class="email">{{ currentUser?.email }}</span>
            </div>
          </div>
          
          <div class="dropdown-divider"></div>
          
          <div class="dropdown-section">
            <button class="dropdown-item" (click)="toggleTheme()">
              <svg class="dropdown-icon" viewBox="0 0 24 24" fill="none">
                <path *ngIf="!isDarkTheme" d="M12 3V1M12 23V21M4.22 4.22L5.64 5.64M18.36 18.36L19.78 19.78M1 12H3M21 12H23M4.22 19.78L5.64 18.36M18.36 5.64L19.78 4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path *ngIf="!isDarkTheme" d="M12 17C14.7614 17 17 14.7614 17 12C17 9.23858 14.7614 7 12 7C9.23858 7 7 9.23858 7 12C7 14.7614 9.23858 17 12 17Z" stroke="currentColor" stroke-width="2"/>
                <path *ngIf="isDarkTheme" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z" stroke="currentColor" stroke-width="2"/>
              </svg>
              <span>{{ isDarkTheme ? 'Light Mode' : 'Dark Mode' }}</span>
            </button>
            
            <button class="dropdown-item" (click)="toggleTemperatureUnit()">
              <svg class="dropdown-icon" viewBox="0 0 24 24" fill="none">
                <path d="M8 12C8 16.4183 11.5817 20 16 20C20.4183 20 24 16.4183 24 12C24 7.58172 20.4183 4 16 4C11.5817 4 8 7.58172 8 12Z" stroke="currentColor" stroke-width="2"/>
                <path d="M12 8V16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M12 4V2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span>{{ temperatureUnit === 'celsius' ? 'Fahrenheit' : 'Celsius' }}</span>
            </button>
            
            <button class="dropdown-item" (click)="toggleNotifications()">
              <svg class="dropdown-icon" viewBox="0 0 24 24" fill="none">
                <path d="M18 8A6 6 0 0 0 6 8C6 15 3 17 3 17H21S18 15 18 8" stroke="currentColor" stroke-width="2"/>
                <path d="M13.73 21A2 2 0 0 1 10.27 21" stroke="currentColor" stroke-width="2"/>
              </svg>
              <span>Notifications</span>
            </button>
          </div>
          
          <div class="dropdown-divider"></div>
          
          <div class="dropdown-section">
            <button class="dropdown-item" (click)="showFavoritesPanel()">
              <svg class="dropdown-icon" viewBox="0 0 24 24" fill="none">
                <path d="M20.84 4.61A5.5 5.5 0 0 0 16.5 2.5C15.09 2.5 13.81 3.07 12.84 4.02L12 4.87L11.16 4.02A5.5 5.5 0 0 0 6.84 2.5A5.5 5.5 0 0 0 1.5 8C1.5 8.91 1.77 9.75 2.25 10.44L12 21L21.75 10.44C22.23 9.75 22.5 8.91 22.5 8A5.5 5.5 0 0 0 20.84 4.61Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
              </svg>
              <span>Favorites</span>
            </button>
            
            <button class="dropdown-item" (click)="showEditProfilePanel()">
              <svg class="dropdown-icon" viewBox="0 0 24 24" fill="none">
                <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
              </svg>
              <span>Edit Profile</span>
            </button>
          </div>
          
          <div class="dropdown-divider"></div>
          
          <div class="dropdown-section">
            <button class="dropdown-item danger" (click)="logout()">
              <svg class="dropdown-icon" viewBox="0 0 24 24" fill="none">
                <path d="M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <polyline points="16,17 21,12 16,7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <line x1="21" y1="12" x2="9" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span>Logout</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Search Section -->
    <section class="search-section">
      <div class="search-container">
        <div class="search-input-container">
          <svg class="search-icon" viewBox="0 0 24 24" fill="none">
            <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
            <path d="21 21L16.65 16.65" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <input 
            type="text" 
            class="search-input"
            [(ngModel)]="searchQuery"
            (keyup.enter)="onSearch()"
            placeholder="Search for a city..."
            autocomplete="off"
          >
          <button 
            class="search-btn" 
            (click)="onSearch()"
            [disabled]="!searchQuery.trim() || isLoading"
          >
            <span *ngIf="!isLoading">Search</span>
            <div *ngIf="isLoading" class="loading-spinner"></div>
          </button>
        </div>
      </div>
    </section>

    <!-- Weather Display Section -->
    <section class="weather-section">
      <div *ngIf="errorMessage" class="error-message">
        <svg class="error-icon" viewBox="0 0 24 24" fill="none">
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
          <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        {{ errorMessage }}
      </div>

      <div *ngIf="weatherData && !errorMessage" class="weather-card" [style.background]="weatherData.backgroundImage">
        <div class="weather-overlay">
          <div class="weather-main">
            <div class="weather-location">
              <h1 class="city-name">{{ weatherData.city }}, {{ weatherData.country }}</h1>
              <button class="favorite-btn" (click)="addToFavorites()" title="Add to favorites">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M20.84 4.61A5.5 5.5 0 0 0 16.5 2.5C15.09 2.5 13.81 3.07 12.84 4.02L12 4.87L11.16 4.02A5.5 5.5 0 0 0 6.84 2.5A5.5 5.5 0 0 0 1.5 8C1.5 8.91 1.77 9.75 2.25 10.44L12 21L21.75 10.44C22.23 9.75 22.5 8.91 22.5 8A5.5 5.5 0 0 0 20.84 4.61Z" 
                        stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>
            
            <div class="weather-temp-container">
              <div class="weather-icon">
                <img [src]="'https://openweathermap.org/img/wn/' + weatherData.icon + '@4x.png'" 
                     [alt]="weatherData.description">
              </div>
              <div class="weather-temp">
                <span class="temperature">{{ getTemperatureDisplay() }}</span>
                <span class="condition">{{ weatherData.condition }}</span>
                <span class="description">{{ weatherData.description }}</span>
              </div>
            </div>
          </div>
          
          <div class="weather-details">
            <div class="detail-item">
              <svg class="detail-icon" viewBox="0 0 24 24" fill="none">
                <path d="M19 14C20.49 12.54 22 10.79 22 8.5C22 5.42 19.58 3 16.5 3C14.24 3 12.36 4.29 11.5 6.17C10.64 4.29 8.76 3 6.5 3C3.42 3 1 5.42 1 8.5C1 10.79 2.51 12.54 4 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16 17L18 19L22 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span class="detail-label">Humidity</span>
              <span class="detail-value">{{ weatherData.humidity }}%</span>
            </div>
            
            <div class="detail-item">
              <svg class="detail-icon" viewBox="0 0 24 24" fill="none">
                <path d="M17.7 7.7A7.1 7.1 0 0 0 5 10.8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M18.5 9.5A4.6 4.6 0 0 0 14 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M8.5 14.5L16.1 6.9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M10.2 16.2L17.8 8.6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M12 18L19.6 10.4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span class="detail-label">Wind Speed</span>
              <span class="detail-value">{{ getWindSpeedDisplay() }}</span>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modals/Panels -->
  <app-favorites 
    *ngIf="showFavorites"
    (close)="showFavorites = false"
    (citySelected)="onFavoriteSelected($event)">
  </app-favorites>

  <app-user-profile
    *ngIf="showEditProfile"
    [user]="currentUser"
    (close)="showEditProfile = false"
    (userUpdated)="onProfileUpdated($event)">
  </app-user-profile>

  <app-notification></app-notification>
</div>


